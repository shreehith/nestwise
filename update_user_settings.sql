DROP TABLE IF EXISTS user_settings; CREATE TABLE user_settings (id UUID PRIMARY KEY DEFAULT gen_random_uuid(), user_id UUID REFERENCES auth.users NOT NULL, darkMode BOOLEAN DEFAULT false, emailNotifications BOOLEAN DEFAULT true, created_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now()) NOT NULL, updated_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now()) NOT NULL, UNIQUE(user_id)); ALTER TABLE user_settings ENABLE ROW LEVEL SECURITY; CREATE POLICY 'Users can view their own settings' ON user_settings FOR SELECT USING (auth.uid() = user_id); CREATE POLICY 'Users can update their own settings' ON user_settings FOR UPDATE USING (auth.uid() = user_id); CREATE POLICY 'Users can insert their own settings' ON user_settings FOR INSERT WITH CHECK (auth.uid() = user_id);
